/*! For license information please see index.b9c97e10cff373144e61.js.LICENSE.txt */
!function(){"use strict";var t={1:function(t,e,r){var n=r(933),i=r.n(n),o=r(476),a=r.n(o)()(i());a.push([t.id,'* {\r\n    -webkit-touch-callout:none;\r\n    -webkit-user-select:none;\r\n    -khtml-user-select:none;\r\n    -moz-user-select:none;\r\n    -ms-user-select:none;\r\n    user-select:none;\r\n    -webkit-tap-highlight-color:rgba(0,0,0,0);\r\n}\r\n\r\nhtml, body {\r\n    width: 100%;\r\n    height: 100%;\r\n    margin: 0;\r\n    overflow: hidden;\r\n}\r\n\r\nbody {\r\n    background-color: #221e24;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n#cnv {\r\n    background-color: #1a181c;\r\n    display: block;\r\n}\r\n\r\n#btnFullscreen {\r\n    position: fixed;\r\n    top: 10px;\r\n    right: 10px;\r\n    width: 18px;\r\n    height: 18px;\r\n    background: none;\r\n    color: #fff;\r\n    border: none;\r\n    outline: none;\r\n    cursor: pointer;\r\n    z-index: 9999;\r\n}\r\n\r\n#btnFullscreen:before,\r\n#btnFullscreen:after {\r\n    content: "";\r\n    display: block;\r\n    position: absolute;\r\n    width: 6px;\r\n    height: 6px;\r\n    border-color: #fff;\r\n    border-style: solid;\r\n}\r\n\r\n\r\n#btnFullscreen:before {\r\n    top: 2px;\r\n    right: 2px;\r\n    border-width: 2px 2px 0 0;\r\n}\r\n\r\n#btnFullscreen:after {\r\n    left: 2px;\r\n    bottom: 2px;\r\n    border-width: 0 0 2px 2px;\r\n}\r\n\r\n#btnFullscreen.active:before {\r\n    top: 0;\r\n    right: 0;\r\n    transform: rotate(180deg);\r\n}\r\n\r\n#btnFullscreen.active:after {\r\n    left: 0;\r\n    bottom: 0;\r\n    transform: rotate(180deg);\r\n}\r\n\r\n',""]),e.Z=a},476:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r})).join("")},e.i=function(t,r,n,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var u=0;u<t.length;u++){var l=[].concat(t[u]);n&&a[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),r&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=r):l[2]=r),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},933:function(t){t.exports=function(t){return t[1]}},892:function(t){var e=[];function r(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function n(t,n){for(var o={},a=[],s=0;s<t.length;s++){var c=t[s],u=n.base?c[0]+n.base:c[0],l=o[u]||0,h="".concat(u," ").concat(l);o[u]=l+1;var f=r(h),y={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)e[f].references++,e[f].updater(y);else{var p=i(y,n);n.byIndex=s,e.splice(s,0,{identifier:h,updater:p,references:1})}a.push(h)}return a}function i(t,e){var r=e.domAPI(e);return r.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;r.update(t=e)}else r.remove()}}t.exports=function(t,i){var o=n(t=t||[],i=i||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=r(o[a]);e[s].references--}for(var c=n(t,i),u=0;u<o.length;u++){var l=r(o[u]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}o=c}}},311:function(t){var e={};t.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},60:function(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},192:function(t,e,r){t.exports=function(t){var e=r.nc;e&&t.setAttribute("nonce",e)}},760:function(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(r){!function(t,e,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var o=r.sourceMap;o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,r)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},865:function(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={id:n,exports:{}};return t[n](o,o.exports,r),o.exports}r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.nc=void 0,function(){var t=r(892),e=r.n(t),n=r(760),i=r.n(n),o=r(311),a=r.n(o),s=r(192),c=r.n(s),u=r(60),l=r.n(u),h=r(865),f=r.n(h),y=r(1),p={};function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==v(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===v(i)?i:String(i)),n)}var i}p.styleTagTransform=f(),p.setAttributes=c(),p.insert=a().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=l(),e()(y.Z,p),y.Z&&y.Z.locals&&y.Z.locals;var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.updates=[],this.fps=60,this.raf=null,this.prevTimestamp=null,this.listener=this.update.bind(this)}var e,r;return e=t,(r=[{key:"start",value:function(){this.prevTimestamp=null,this.raf=requestAnimationFrame(this.listener)}},{key:"stop",value:function(){cancelAnimationFrame(this.listener),this.raf=null}},{key:"add",value:function(t,e){this.checkName(t)||(this.updates.push({name:t,callback:e}),null===this.raf&&this.start())}},{key:"remove",value:function(t){var e=this.updates.findIndex((function(e){return e.name===t}));-1!==e&&this.updates.splice(e,1)}},{key:"checkName",value:function(t){return-1!==this.updates.findIndex((function(e){return e.name===t}))}},{key:"update",value:function(t){if(this.updates.length){var e=null===this.prevTimestamp?1:(t-this.prevTimestamp)*this.fps/1e3;this.prevTimestamp=t,this.updates.forEach((function(t){return t.callback(e)})),this.raf=requestAnimationFrame(this.listener)}else this.stop()}}])&&d(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w(n.key),n)}}function w(t){var e=function(t,e){if("object"!==b(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===b(e)?e:String(e)}var S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._x=0,this._y=0,this.object=null}var e,r;return e=t,r=[{key:"x",get:function(){return this.hasFollow&&(this._x=this.object.x),this._x}},{key:"y",get:function(){return this.hasFollow&&(this._y=this.object.y),this._y}},{key:"position",get:function(){var t=app.size;return{top:this.y-t.h/2,right:this.x+t.w/2,bottom:this.y+t.h/2,left:this.x-t.w/2}}},{key:"size",get:function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach((function(e){var n,i,o;n=t,i=e,o=r[e],(i=w(i))in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},app.size)}},{key:"hasFollow",get:function(){return null!==this.object}},{key:"follow",value:function(t){this.object=t}},{key:"unFollow",value:function(){this.object=null}},{key:"reset",value:function(){this._x=0,this._y=0}}],r&&x(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==P(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===P(i)?i:String(i)),n)}var i}var O=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keys={},this.codes={},this.events=[{name:"keyup",handler:this.keyUp.bind(this)},{name:"keydown",handler:this.keyDown.bind(this)},{name:"blur",handler:this.resetKeys.bind(this)},{name:"contextmenu",handler:this.resetKeys.bind(this)}],this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){this.add("up",["KeyW","ArrowUp"]),this.add("down",["KeyS","ArrowDown"]),this.add("left",["KeyA","ArrowLeft"]),this.add("right",["KeyD","ArrowRight"]),this.events.forEach((function(t){return window.addEventListener(t.name,t.handler)}))}},{key:"destroy",value:function(){this.keys={},this.codes={},this.events.forEach((function(t){return window.removeEventListener(t.name,t.handler)}))}},{key:"add",value:function(t,e){var r=this;e.forEach((function(e){r.codes.hasOwnProperty(e)||(r.keys[t]=0,r.codes[e]=t)}))}},{key:"remove",value:function(t){if(this.keys.hasOwnProperty(t)){for(var e in this.codes)this.codes[e]===t&&delete this.codes[e];delete this.keys[t]}}},{key:"getState",value:function(t){return this.keys[t]}},{key:"setState",value:function(t,e){this.codes.hasOwnProperty(t)&&(this.keys[this.codes[t]]=e)}},{key:"keyUp",value:function(t){this.setState(t.code,0)}},{key:"keyDown",value:function(t){this.setState(t.code,1)}},{key:"resetKeys",value:function(){for(var t in this.codes)this.setState(t,0)}}])&&k(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==j(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===j(i)?i:String(i)),n)}var i}var R=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.current=null,this.scenes={},this.layers=[]}var e,r;return e=t,(r=[{key:"add",value:function(t,e){this.scenes.hasOwnProperty(t)?console.log('Сцена "'.concat(t,'" уже добавлена')):this.scenes[t]=e}},{key:"addLayer",value:function(t,e){this.layers.find((function(e){return e.name===t}))||this.layers.push({name:t,layer:new e(this.ctx)})}},{key:"removeLayer",value:function(t){this.layers=this.layers.filter((function(e){return e.name!==t}))}},{key:"getLayer",value:function(t){var e;return(null===(e=this.layers.find((function(e){return e.name===t})))||void 0===e?void 0:e.layer)||null}},{key:"start",value:function(t,e){this.scenes.hasOwnProperty(t)?this.current=new this.scenes[t](this.ctx,e):console.log('Сцена "'.concat(t,'" не найдена'))}},{key:"remove",value:function(){}},{key:"draw",value:function(){null!==this.current&&"draw"in this.current&&this.current.draw(),this.layers.forEach((function(t){"draw"in t.layer&&t.layer.draw()}))}},{key:"update",value:function(t){null!==this.current&&"update"in this.current&&this.current.update(t),this.layers.forEach((function(e){"draw"in e.layer&&e.layer.update(t)}))}}])&&M(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==E(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===E(i)?i:String(i)),n)}var i}var C=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cnv=e,this.originSize={w:r,h:n},this.currentSize={w:r,h:n},this.scale=1,this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){window.addEventListener("resize",this.update.bind(this)),this.update()}},{key:"size",get:function(){return this.currentSize}},{key:"update",value:function(){this.scale=Math.min(document.documentElement.clientWidth/this.originSize.w,document.documentElement.clientHeight/this.originSize.h),this.cnv.width=this.originSize.w*this.scale,this.cnv.height=this.originSize.h*this.scale,this.currentSize.w=this.cnv.width/this.scale,this.currentSize.h=this.cnv.height/this.scale}}])&&T(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==A(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===A(i)?i:String(i)),n)}var i}var L=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._data=r}var e,r;return e=t,(r=[{key:"getData",value:function(){var t={},e=JSON.parse(localStorage.getItem(this._name))||{};for(var r in this._data)t[r]=A(e[r])===A(this._data[r])?e[r]:this._data[r];return t}},{key:"setData",value:function(t){var e={},r=this.getData();for(var n in this._data)e[n]=A(t[n])===A(this._data[n])?t[n]:r[n];localStorage.setItem(this._name,JSON.stringify(e))}}])&&B(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function I(t,e){return e.hasOwnProperty(t)?e[t]:e[e.default]}var _={get TITLE(){return I(app.user.lang,{ru:"Астероиды",en:"Asteroids",tr:"Asteroitler",default:"ru"})},get SCORE(){return I(app.user.lang,{ru:"Счёт",en:"Score",tr:"Hesap",default:"ru"})},get RECORD(){return I(app.user.lang,{ru:"Рекорд",en:"Record",tr:"Rekor",default:"ru"})},get NEW_RECORD(){return I(app.user.lang,{ru:"Новый рекорд",en:"New record",tr:"Yeni rekor",default:"ru"})},get PLAY(){return I(app.user.lang,{ru:"Играть",en:"Play",tr:"Oynamak",default:"ru"})},get BACK(){return I(app.user.lang,{ru:"Назад",en:"Back",tr:"Geri",default:"ru"})},get CONTROL(){return I(app.user.lang,{ru:"Управление",en:"Control",tr:"Yönetim",default:"ru"})},get ABOUT_THE_GAME(){return I(app.user.lang,{ru:"Об игре",en:"About the game",tr:"Oyun hakkında",default:"ru"})},get ABOUT_THE_GAME_DESCRIPTION(){return I(app.user.lang,{ru:"Вам предстоит управлять космическим кораблем и сражаться с бесконечным\nпотоком астероидов. Используйте щиты, которые выпадают из астероидов,\nдля защиты своего корабля от разрушительных столкновений.\n\nГлавная цель — собрать как можно больше очков и подняться на вершину\nтаблицы лидеров",en:"You have to control a spaceship and fight an endless stream of asteroids.\nUse shields that fall out of asteroids, to protect your ship from\ndestructive collisions.\n\nThe main goal is to collect as many points as possible and climb to the top\nof the leaderboard",tr:"Bir uzay gemisini kontrol etmeli ve sonsuz bir asteroit akışıyla\nsavaşmalısınız. Geminizi yıkıcı çarpışmalardan korumak için asteroitlerden\ndüşen kalkanları kullanın.\n\nAsıl amaç mümkün olduğunca çok puan toplamak ve skor tablosunun tepesine\ntırmanmaktır",default:"ru"})},get AGAIN(){return I(app.user.lang,{ru:"Заново",en:"Again",tr:"Yeniden",default:"ru"})},get EXIT(){return I(app.user.lang,{ru:"Выход",en:"Exit",tr:"Çıkış",default:"ru"})},get CONTROL_FROM_PC(){return{TITLE:I(app.user.lang,{ru:"Управление с ПК:",en:"Control from a PC:",tr:"PC'den kontrol:",default:"ru"}),ITEMS:[I(app.user.lang,{ru:"- Для движения используйте клавиши WASD или стрелки на клавиатуре",en:"- To move, use the WASD keys or the arrows on the keyboard",tr:"- Hareket etmek için klavyenizdeki WASD tuşlarını veya ok tuşlarını\n  kullanın",default:"ru"}),I(app.user.lang,{ru:"- Для стрельбы нажимайте или удерживайте левую кнопку мыши в любой\n  точке игрового поля",en:"- To shoot, press or hold the left mouse button at any the point\n  of the playing field",tr:"- Ateş etmek için, oyun alanının herhangi bir yerinde sol fare\n  düğmesini basılı tutun veya basılı tutun",default:"ru"})]}},get CONTROL_FROM_MOBILE(){return{TITLE:I(app.user.lang,{ru:"Управление с мобильного:",en:"Mobile control:",tr:"Mobil cihazdan kontrol:",default:"ru"}),ITEMS:[I(app.user.lang,{ru:"- Для движения используйте экранные кнопки в форме стрелок",en:"- To move, use the on-screen buttons in the form of arrows",tr:"- Hareket etmek için ok şeklindeki ekran düğmelerini kullanın",default:"ru"}),I(app.user.lang,{ru:'- Для стрельбы нажимайте или удерживайте экранную кнопку "прицел"',en:'- To shoot, press or hold the on-screen "sight" button',tr:'- Ateş etmek için ekrandaki "görme" düğmesine basın veya basılı tutun',default:"ru"})]}}};function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==D(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===D(i)?i:String(i)),n)}var i}var F=function(){function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.score=0,this.record=0,this.lang=null!==(e=navigator.language||navigator.userLanguage)&&void 0!==e?e:"ru",this.supportedLanguages=["ru","en","tr"],this.db=new L("asteroids__user",{record:this.record,lang:this.lang}),this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){var t=this.db.getData();this.record=t.record,this.lang=t.lang}},{key:"setStorageData",value:function(){this.db.setData({record:this.record,lang:this.lang})}},{key:"upScore",value:function(t){this.score+=t,this.score>this.record&&(this.record=this.score,this.setStorageData())}},{key:"resetScore",value:function(){this.score=0}},{key:"changeLanguage",value:function(t){this.supportedLanguages.includes(t)&&(this.lang=t,document.title=_.TITLE,this.setStorageData())}},{key:"endGame",value:function(){this.resetScore(),this.setStorageData()}}])&&z(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==N(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===N(i)?i:String(i)),n)}var i}var G=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.buttons={},this.listeners=[]}var e,r;return e=t,(r=[{key:"add",value:function(t,e){this.buttons.hasOwnProperty(t)||(this.buttons[t]={}),this.buttons[t][e]=0}},{key:"remove",value:function(t,e){this.buttons.hasOwnProperty(t)&&this.buttons[t].hasOwnProperty(e)&&(delete this.buttons[t][e],0===Object.keys(this.buttons[t]).length&&delete this.buttons[t])}},{key:"getState",value:function(t,e){if(this.buttons.hasOwnProperty(t)){if(this.buttons[t].hasOwnProperty(e))return this.buttons[t][e];console.log('Имя "'.concat(e,'" не найдено'))}else console.log('Тип "'.concat(t,'" не найден'))}},{key:"setState",value:function(t,e,r){this.buttons.hasOwnProperty(t)?this.buttons[t].hasOwnProperty(e)?(this.buttons[t][e]=r,this.event(t,e)):console.log('Имя "'.concat(e,'" не найдено')):console.log('Тип "'.concat(t,'" не найден'))}},{key:"event",value:function(t,e){var r=this;this.listeners.forEach((function(n){n.type===t&&n.name===e&&n.handler(r.buttons[t][e])}))}},{key:"on",value:function(t,e,r){this.listeners.push({type:t,name:e,handler:r})}},{key:"off",value:function(t,e){this.listeners=this.listeners.filter((function(r){return r.type!==t&&r.name!==e}))}}])&&W(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Y(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Y(i)?i:String(i)),n)}var i}var H=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cnv=e,this.ctx=e.getContext("2d"),this.scaleManager=new C(e,1920,1080),this.ticker=new m,this.camera=new S(this.size),this.keyboard=new O,this.scene=new R(this.ctx),this.user=new F,this.stateButtons=new G,this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){this.ticker.add("app-update",this.update.bind(this))}},{key:"scale",get:function(){return this.scaleManager.scale}},{key:"size",get:function(){return this.scaleManager.size}},{key:"update",value:function(t){this.scene.update(t),this.ctx.setTransform(this.scale,0,0,this.scale,0,0),this.ctx.clearRect(0,0,this.size.w,this.size.h),this.ctx.translate(this.size.w/2-app.camera.x,this.size.h/2-app.camera.y),this.scene.draw()}}])&&X(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==q(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===q(i)?i:String(i)),n)}var i}var K=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"getRandomBoolean",value:function(){return Math.random()<.5}},{key:"getRandomInteger",value:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}},{key:"getRandomDecimal",value:function(t,e,r){var n=Math.pow(10,r);return t*=n,e*=n,Math.floor(Math.random()*(e-t+1)+t)/n}},{key:"getRandomArguments",value:function(){var t=Array.from(arguments);return t[Math.floor(Math.random()*t.length)]}},{key:"distance",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return Math.hypot(t.x-e.x,t.y-e.y)}},{key:"velocity",value:function(t,e){var r=this.distance(t);return{x:r>e?t.x/r*e:t.x,y:r>e?t.y/r*e:t.y}}},{key:"getRandomPositionOnBordersRect",value:function(t){var e=t.top,r=t.right,n=t.bottom,i=t.left;return Math.random()<.5?{x:Math.random()<.5?i:r,y:Math.random()*(n-e)+e}:{x:Math.random()*(r-i)+i,y:Math.random()<.5?e:n}}},{key:"getRandomPolygon",value:function(e){for(var r=e.min,n=void 0===r?50:r,i=e.max,o=void 0===i?150:i,a=e.num,s=void 0===a?8:a,c=[],u=2*Math.PI/s,l=0;l<s;l++){var h=u*l,f=t.getRandomInteger(n,o);c.push({x:Math.cos(h)*f,y:Math.sin(h)*f})}return c}},{key:"getPathRoundedPolygon",value:function(t,e){var r,n,i,o,a,s,c,u,l,h,f,y,p,v,d,m,b,g,x=[],w=[],S=function(t,e,r){r.x=e.x-t.x,r.y=e.y-t.y,r.len=Math.sqrt(r.x*r.x+r.y*r.y),r.nx=r.x/r.len,r.ny=r.y/r.len,r.ang=Math.atan2(r.ny,r.nx)};for(g=e,u={},l={},a=t[(o=t.length)-1],r=0;r<o;r++){s=t[r%o],c=t[(r+1)%o],S(s,a,u),S(s,c,l),h=u.nx*l.ny-u.ny*l.nx,f=u.nx*l.nx-u.ny*-l.ny,v=Math.asin(h<-1?-1:h>1?1:h),y=1,p=!1,f<0?v<0?v=Math.PI+v:(v=Math.PI-v,y=-1,p=!0):v>0&&(y=-1,p=!0),g=void 0!==s.radius?s.radius:e,d=v/2,(b=Math.abs(Math.cos(d)*g/Math.sin(d)))>Math.min(u.len/2,l.len/2)?(b=Math.min(u.len/2,l.len/2),m=Math.abs(b*Math.sin(d)/Math.cos(d))):m=g,n=s.x+l.nx*b,i=s.y+l.ny*b,n+=-l.ny*m*y,i+=l.nx*m*y;var P=u.ang+Math.PI/2*y,k=l.ang-Math.PI/2*y;x.push({data:{x:n,y:i,cRadius:m,startAngle:P,endAngle:k,drawDirection:p},draw:function(t,e){var r=e.x,n=e.y,i=e.cRadius,o=e.startAngle,a=e.endAngle,s=e.drawDirection;t.arc(r,n,i,o,a,s)}});var O={x:n+Math.cos(P)*m,y:i+Math.sin(P)*m},j={x:n+Math.cos(k)*m,y:i+Math.sin(k)*m},M=p?P-k:k-P;M<0&&(M+=2*Math.PI);var R=p?P-M/2:P+M/2,E={x:n+Math.cos(R)*m,y:i+Math.sin(R)*m};w.push(O),w.push(E),w.push(j),a=s,s=c}return{path2D:x,polygon:w}}},{key:"isTouchDevice",get:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}},{key:"fullScreen",value:function(t){document.fullscreenElement?document.exitFullscreen:document.documentElement.requestFullscreen()}},{key:"drawRect",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff";t.save(),t.strokeStyle=r,t.strokeRect(e.x,e.y,e.w,e.h),t.restore()}},{key:"drawPolygon",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff";t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=r,e.forEach((function(e,r){0===r&&t.moveTo(e.x,e.y),t.lineTo(e.x,e.y)})),t.closePath(),t.stroke(),t.restore()}}],null&&U(e.prototype,null),r&&U(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function J(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Z(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Z(i)?i:String(i)),n)}var i}var V=function(){function t(e,r){var n=r.x,i=r.y,o=r.r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=n,this.y=i,this.r=o,this.color=K.getRandomArguments("hsl(264,10%,40%)","hsl(221,10%,40%)")}var e,r;return e=t,(r=[{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.fillStyle=this.color,this.ctx.arc(0,0,this.r,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}}])&&J(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function Q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==$(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===$(i)?i:String(i)),n)}var i}var tt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.items=[],this.minRadius=4,this.maxRadius=6,this.cell=350}var e,r;return e=t,(r=[{key:"draw",value:function(){var t=app.camera.position;this.items.forEach((function(e){e.star.x+e.star.r>t.left&&e.star.x-e.star.r<t.right&&e.star.y+e.star.r>t.top&&e.star.y-e.star.r<t.bottom&&e.star.draw()}))}},{key:"update",value:function(t){var e=this,r=Math.ceil(app.camera.size.w/2/this.cell)*this.cell,n=Math.ceil(app.camera.size.h/2/this.cell)*this.cell,i=app.camera.y-n-this.cell,o=app.camera.x-r-this.cell,a=app.camera.y+n,s=app.camera.x+r,c=Math.round((s-o)/this.cell),u=Math.round((a-i)/this.cell),l=app.camera.x>0?app.camera.x%this.cell-this.cell:app.camera.x%this.cell,h=app.camera.y>0?app.camera.y%this.cell-this.cell:app.camera.y%this.cell;this.items=this.items.filter((function(t){return t.x>=o&&t.x<=s&&t.y>=i&&t.y<=a}));for(var f=function(){for(var t=Math.round(o+e.cell*y-l),r=function(){var r=Math.round(i+e.cell*n-h);e.items.some((function(e){return e.x===t&&e.y===r}))||e.items.push({x:t,y:r,star:new V(e.ctx,{x:K.getRandomInteger(t,t+e.cell),y:K.getRandomInteger(r,r+e.cell),r:K.getRandomInteger(e.minRadius,e.maxRadius)})})},n=0;n<u;n++)r()},y=0;y<c;y++)f()}}])&&Q(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==et(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===et(i)?i:String(i)),n)}var i}function nt(t,e,r){return e&&rt(t.prototype,e),r&&rt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var it=nt((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Polygon",this.points=e}));function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ot(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ot(i)?i:String(i)),n)}var i}var st=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"getCenterMassConvexPolygon",value:function(t){if(t.length<3)return{x:0,y:0};for(var e=0,r=0,n=0,i=0;i<t.length;i++){var o=t[i].x,a=t[i].y,s=t[(i+1)%t.length].x,c=t[(i+1)%t.length].y,u=o*c-s*a;e+=u,r+=(o+s)*u,n+=(a+c)*u}return{x:r/=6*(e/=2),y:n/=6*e}}},{key:"getCenterPolygon",value:function(t){var e=t.reduce((function(t,e){return t.x+=e.x,t.y+=e.y,t}),{x:0,y:0});return{x:e.x/t.length,y:e.y/t.length}}},{key:"getFarPointPolygonCenterDistance",value:function(t){var e=this.getCenterMassConvexPolygon(t),r=t[0],n=K.distance(t[0],e);return t.forEach((function(t){K.distance(t,e)>K.distance(r,e)&&(r=t,n=K.distance(t,e))})),n}},{key:"getRectFromPolygonRotate",value:function(t){var e=this.getFarPointPolygonCenterDistance(t);return{x:-e,y:-e,w:2*e,h:2*e}}},{key:"getCircleFromPolygonRotate",value:function(t){return{x:0,y:0,r:this.getFarPointPolygonCenterDistance(t)}}},{key:"getRectOnMoveRect",value:function(t,e,r){return{x:t.x+Math.min(e,0),y:t.y+Math.min(r,0),w:t.w+Math.abs(e),h:t.h+Math.abs(r)}}},{key:"getRectOnMoveCircle",value:function(t,e,r){var n=t.x+e,i=t.y+r,o=Math.min(t.x,n)-t.r,a=Math.min(t.y,i)-t.r;return{x:o,y:a,w:Math.max(t.x,n)+t.r-o,h:Math.max(t.y,i)+t.r-a}}},{key:"getPolygonOnMoveCircle",value:function(t,e,r){var n=t,i=n.x+e,o=n.y+r,a=Math.atan2(o-n.y,i-n.x),s=Math.cos(a),c=Math.cos(a-Math.PI/2),u=Math.cos(a+Math.PI/2),l=Math.cos(a+Math.PI),h=Math.sin(a),f=Math.sin(a-Math.PI/2),y=Math.sin(a+Math.PI/2),p=Math.sin(a+Math.PI);return[{x:n.x+l*n.r,y:n.y+p*n.r},{x:n.x+c*n.r,y:n.y+f*n.r},{x:i+c*n.r,y:o+f*n.r},{x:i+s*n.r,y:o+h*n.r},{x:i+u*n.r,y:o+y*n.r},{x:n.x+u*n.r,y:n.y+y*n.r}]}}],null&&at(e.prototype,null),r&&at(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ct(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ct(i)?i:String(i)),n)}var i}var lt=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.polygon=e,this.path2D=new Path2D,this.radius=r,this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){var t=this,e=K.getPathRoundedPolygon(this.polygon,this.radius),r=e.polygon,n=e.path2D,i=st.getCenterMassConvexPolygon(r);r.forEach((function(t){t.x-=i.x,t.y-=i.y})),n.forEach((function(e){e.data.x-=i.x,e.data.y-=i.y,e.draw(t.path2D,e.data)})),this.path2D.closePath(),this.polygon=r}}])&&ut(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ht(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ht(i)?i:String(i)),n)}var i}var yt=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=r.x||0,this.y=r.y||0,this.rotate=0,this.speed=r.speed||0,this.direction=r.direction||0,this.step=K.velocity({x:Math.cos(this.direction)*this.speed,y:Math.sin(this.direction)*this.speed},this.speed),this.stepRotate=K.getRandomDecimal(-.02,.02,2),this.figure=new lt(K.getRandomPolygon({min:r.min||K.getRandomInteger(30,50),max:r.max||K.getRandomInteger(100,150),num:K.getRandomInteger(4,8)}),K.getRandomInteger(70,100)),this.path2D=this.figure.path2D,this.shapePolygon=new it(this.figure.polygon),this.shapeRect=st.getRectFromPolygonRotate(this.shapePolygon.points),this.color=r.color||K.getRandomArguments("hsl(0, 50%, 50%)","hsl(120, 35%, 50%)","hsl(230, 50%, 50%)"),this.destroyed=!1}var e,r;return e=t,(r=[{key:"getShapeRect",value:function(t,e){return st.getRectOnMoveRect({x:this.x+this.shapeRect.x,y:this.y+this.shapeRect.y,w:this.shapeRect.w,h:this.shapeRect.h},t,e)}},{key:"getShapePolygon",value:function(t,e,r){var n=this;return this.shapePolygon.points.map((function(i){var o=K.distance(i),a=Math.atan2(i.y,i.x)+n.rotate+r;return{x:n.x+t+Math.cos(a)*o,y:n.y+e+Math.sin(a)*o}}))}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(this.rotate),this.ctx.lineWidth=5,this.ctx.strokeStyle=this.color,this.ctx.stroke(this.path2D),this.ctx.restore()}},{key:"getNextMove",value:function(t){return{x:this.step.x*t,y:this.step.y*t}}},{key:"getNextRotate",value:function(t){return this.stepRotate*t}},{key:"update",value:function(t){this.x+=this.step.x*t,this.y+=this.step.y*t,this.rotate+=this.stepRotate*t}}])&&ft(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==pt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===pt(i)?i:String(i)),n)}var i}var dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"RectRect",value:function(t,e){return t.x+t.w>e.x&&t.x<e.x+e.w&&t.y+t.h>e.y&&t.y<e.y+e.h}},{key:"getLinesPolygon",value:function(t){return t.map((function(t,e,r){return e<r.length-1?[t,r[e+1]]:[t,r[0]]}))}},{key:"lineIntersection",value:function(t,e){var r=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),n=(e.x2-e.x1)*(t.y2-e.y1)-(e.y2-e.y1)*(t.x2-e.x1),i=(t.x2-t.x1)*(e.y1-t.y1)-(t.y2-t.y1)*(e.x1-t.x1),o=(t.x2-t.x1)*(e.y2-t.y1)-(t.y2-t.y1)*(e.x2-t.x1);return r*n<0&&i*o<0}},{key:"PointPolygon",value:function(t,e){for(var r=!1,n=0,i=e.length-1;n<e.length;i=n++)e[n].y>t.y!=e[i].y>t.y&&t.x<(e[i].x-e[n].x)*(t.y-e[n].y)/(e[i].y-e[n].y)+e[n].x&&(r=!r);return r}},{key:"PolygonPolygon",value:function(t,e){for(var r=0;r<t.length;r++)if(this.PointPolygon(t[r],e))return!0;for(var n=0;n<e.length;n++)if(this.PointPolygon(e[n],t))return!0;return!1}},{key:"createBulletPolygon",value:function(t,e,r){var n=Math.atan2(e.y-t.y,e.x-t.x);return[{x:t.x+Math.cos(n+Math.PI)*r,y:t.y+Math.sin(n+Math.PI)*r},{x:t.x+Math.cos(n-Math.PI/2)*r,y:t.y+Math.sin(n-Math.PI/2)*r},{x:e.x+Math.cos(n-Math.PI/2)*r,y:e.y+Math.sin(n-Math.PI/2)*r},{x:e.x+Math.cos(n)*r,y:e.y+Math.sin(n)*r},{x:e.x+Math.cos(n+Math.PI/2)*r,y:e.y+Math.sin(n+Math.PI/2)*r},{x:t.x+Math.cos(n+Math.PI/2)*r,y:t.y+Math.sin(n+Math.PI/2)*r}]}}],null&&vt(e.prototype,null),r&&vt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function bt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function gt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(r),!0).forEach((function(e){var n,i,o;n=t,i=e,o=r[e],(i=wt(i))in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wt(n.key),n)}}function wt(t){var e=function(t,e){if("object"!==mt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===mt(e)?e:String(e)}var St=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.scene=r,this.asteroids=[],this.maxNum=n.maxNum||5,this.timoutCreateAsteroids=100*this.maxNum,this.boostState=!1,this.boost=0,this.boostStep=0,this.boostMax=0,this.offsetCreate=150,this.offsetRemove=200}var e,r;return e=t,r=[{key:"setBoost",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.boostState=t,this.boost=0,this.boostStep=e,this.boostMax=r}},{key:"clear",value:function(){for(var t=0;t<this.asteroids.length;t++){var e=this.asteroids[t].getShapeRect(0,0);this.scene.systemCollisionParticles.create(this.asteroids[t].x,this.asteroids[t].y,e.w,e.h,this.asteroids[t].color)}this.asteroids.length=0}},{key:"resetCreateTimeout",value:function(){this.timoutCreateAsteroids=100*this.maxNum}},{key:"createAsteroid",value:function(t){this.asteroids.push(new yt(this.ctx,t))}},{key:"createAsteroidFragment",value:function(t){var e=t.x,r=t.y,n=t.dist,i=t.angle,o=t.minW,a=t.maxW,s=t.color,c=t.speed,u=void 0===c?K.getRandomInteger(4,6):c,l=K.getRandomDecimal(-Math.PI/6,Math.PI/6,2);return{color:s,speed:u,x:e+Math.cos(i+l)*n,y:r+Math.sin(i+l)*n,min:o,max:a,direction:i+l}}},{key:"addAsteroids",value:function(t){var e=this;t.forEach((function(t){return e.createAsteroid(t)}))}},{key:"generateAsteroid",value:function(t){if(!(this.asteroids.length>=this.maxNum))if(this.timoutCreateAsteroids>100*(this.maxNum-this.asteroids.length))this.timoutCreateAsteroids-=1*t;else{this.boostState&&this.boost<this.boostMax&&(this.boost+=this.boostStep);var e=app.camera.position,r=app.camera.size,n=r.w/8,i=r.h/8,o=K.getRandomPositionOnBordersRect({top:e.top-this.offsetCreate,right:e.right+this.offsetCreate,bottom:e.bottom+this.offsetCreate,left:e.left-this.offsetCreate}),a=K.getRandomInteger(e.left+n,e.right-n),s=K.getRandomInteger(e.top+i,e.bottom-i);this.createAsteroid(gt(gt({},o),{},{direction:Math.atan2(s-o.y,a-o.x),speed:K.getRandomInteger(2,4)+this.boost}))}}},{key:"draw",value:function(){var t=app.camera.position,e={x:t.left,y:t.top,w:t.right-t.left,h:t.bottom-t.top};this.asteroids.forEach((function(t){!t.destroyed&&dt.RectRect(e,t.getShapeRect(0,0))&&t.draw()}))}},{key:"update",value:function(t){for(var e=this,r=app.camera.position,n=[],i=0;i<this.asteroids.length-1;i++)if(!this.asteroids[i].destroyed)for(var o=this.asteroids[i],a=o.getNextMove(t),s=o.getNextRotate(t),c=o.getShapeRect(a.x,a.y),u=i+1;u<this.asteroids.length;u++)if(!this.asteroids[u].destroyed){var l=this.asteroids[u],h=l.getNextMove(t),f=l.getNextRotate(t),y=l.getShapeRect(h.x,h.y);if(dt.RectRect(c,y)){var p=o.getShapePolygon(a.x,a.y,s),v=l.getShapePolygon(h.x,h.y,f);if(dt.PolygonPolygon(p,v)){if(c.w*c.h>3e4||y.w*y.h>3e4){var d=(o.x+l.x)/2,m=(o.y+l.y)/2,b=Math.max(c.w,y.w),g=Math.round(b/8),x=Math.round(b/4),w=K.getRandomDecimal(0,2*Math.PI,2),S=c.w>y.w?o.color:l.color,P=c.w>y.w?l.color:o.color,k=Math.min(Math.max(o.speed,l.speed)+2,8);n.push(this.createAsteroidFragment({speed:k,dist:g+x,minW:g,maxW:x,x:d,y:m,color:S,angle:w}),this.createAsteroidFragment({speed:k,dist:g+x,minW:g,maxW:x,x:d,y:m,color:S,angle:w+Math.PI/1.5}),this.createAsteroidFragment({speed:k,dist:g+x,minW:g,maxW:x,x:d,y:m,color:P,angle:w+Math.PI/1.5*2}))}this.scene.systemCollisionParticles.create(o.x,o.y,c.w,c.h,o.color),this.scene.systemCollisionParticles.create(l.x,l.y,y.w,y.h,l.color),o.destroyed=!0,l.destroyed=!0;break}}}this.asteroids=this.asteroids.filter((function(n){return!(n.destroyed||n.x+n.shapeRect.w/2+e.offsetRemove<r.left||n.x-n.shapeRect.w/2-e.offsetRemove>r.right||n.y+n.shapeRect.h/2+e.offsetRemove<r.top||n.y-n.shapeRect.h/2-e.offsetRemove>r.bottom||(n.update(t),0))})),this.addAsteroids(n),this.generateAsteroid(t)}}],r&&xt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function kt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Pt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Pt(i)?i:String(i)),n)}var i}var Ot=function(){function t(e,r){var n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=r.x||0,this.y=r.y||0,this.isActive=null===(n=r.isActive)||void 0===n||n,this.fz=52,this.w=0,this.h=2*this.fz+20,this.text="".concat(r.text||"button"),this.font="".concat(this.fz,"px Balsamiq Sans"),this.hover=0,this.handler=r.handler||function(){},this.clickHandler=this.click.bind(this),this.mousemoveHandler=this.mousemove.bind(this),this.isActive=null===(i=r.isActive)||void 0===i||i,this.init(),this.isActive&&this.addListeners()}var e,r;return e=t,(r=[{key:"init",value:function(){this.ctx.save(),this.ctx.font=this.font;var t=this.ctx.measureText(this.text);this.w=t.width+this.h,this.ctx.restore()}},{key:"destroy",value:function(){this.removeListeners()}},{key:"setActive",value:function(t){this.isActive=t,this.isActive?this.addListeners():this.removeListeners()}},{key:"addListeners",value:function(){app.cnv.addEventListener("click",this.clickHandler),app.cnv.addEventListener("mousemove",this.mousemoveHandler)}},{key:"removeListeners",value:function(){app.cnv.removeEventListener("click",this.clickHandler),app.cnv.removeEventListener("mousemove",this.mousemoveHandler),this.hover=0}},{key:"click",value:function(t){var e=app.cnv.getBoundingClientRect(),r=(t.clientX-e.left)/app.scale-app.size.w/2,n=(t.clientY-e.top)/app.scale-app.size.h/2;r>this.x-this.w/2&&r<this.x+this.w/2&&n>this.y-this.h/2&&n<this.y+this.h/2&&this.handler()}},{key:"mousemove",value:function(t){var e=app.cnv.getBoundingClientRect(),r=(t.clientX-e.x)/app.scale-app.size.w/2,n=(t.clientY-e.y)/app.scale-app.size.h/2;this.hover=r>this.x-this.w/2&&r<this.x+this.w/2&&n>this.y-this.h/2&&n<this.y+this.h/2}},{key:"updatePosition",value:function(t,e){this.x=t,this.y=e}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.fillStyle="rgba(173, 154, 194, ".concat(this.hover?.1:.05,")"),this.ctx.arc(-this.w/2+this.h/2,0,this.h/2,Math.PI/2,-Math.PI/2),this.ctx.arc(this.w/2-this.h/2,0,this.h/2,-Math.PI/2,Math.PI/2),this.ctx.fill(),this.ctx.fillStyle="rgb(202,199,206)",this.ctx.font=this.font,this.ctx.fillText(this.text,-this.w/2+this.h/2,18),this.ctx.restore()}}])&&kt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==jt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===jt(i)?i:String(i)),n)}var i}var Rt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=0,this.y=0,this.icon=new lt([{x:0,y:80},{x:40,y:0},{x:80,y:80},{x:40,y:60}],5),this.iconPosition={x:0,y:0},this.iconShapeRect=st.getRectFromPolygonRotate(this.icon.polygon),this.color="#96919d",this.rotate=0,this.stepRotate=.14,this.isLoaded=!1,this.backAlpha=1,this.speed=0,this.timeout=15,this.loadedCallback=null}var e,r;return e=t,r=[{key:"loaded",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.loadedCallback=t,this.isLoaded=!0}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.fillStyle="rgba(34, 30, 36, ".concat(this.backAlpha,")"),this.ctx.fillRect(-app.size.w/2,-app.size.h/2,app.size.w,app.size.h),this.ctx.translate(this.iconPosition.x,this.iconPosition.y),this.ctx.rotate(this.rotate),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle=this.color,this.ctx.stroke(this.icon.path2D),this.ctx.restore()}},{key:"iconVisible",value:function(){return dt.RectRect({x:this.iconPosition.x+this.iconShapeRect.x,y:this.iconPosition.y+this.iconShapeRect.y,w:this.iconShapeRect.w,h:this.iconShapeRect.h},{x:-app.size.w/2,y:-app.size.h/2,w:app.size.w,h:app.size.h})}},{key:"update",value:function(t){if(!this.isLoaded||this.timeout||this.iconVisible()||this.backAlpha){if(this.isLoaded&&!this.timeout&&this.stepRotate<=.07){this.speed+=.5*t,this.stepRotate=Math.max(this.stepRotate-.001*t,0),this.backAlpha=Math.max(this.backAlpha-.015*t,0);var e=K.velocity({x:Math.cos(this.rotate-Math.PI/2)*this.speed,y:Math.sin(this.rotate-Math.PI/2)*this.speed},this.speed),r=e.x,n=e.y;this.iconPosition.x+=r*t,this.iconPosition.y+=n*t,null!==this.loadedCallback&&this.backAlpha<.8&&(this.loadedCallback(),this.loadedCallback=null)}else this.isLoaded&&!this.timeout&&this.stepRotate>.07&&(this.stepRotate=Math.max(this.stepRotate-.001*t,0));this.timeout=Math.max(this.timeout-1*t,0),this.rotate+=this.stepRotate*t,this.rotate>2*Math.PI&&(this.rotate-=2*Math.PI)}else app.scene.removeLayer("Load")}}],r&&Mt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function Tt(t){return function(t){if(Array.isArray(t))return Ct(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ct(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ct(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function At(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Et(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Et(i)?i:String(i)),n)}var i}var Bt=function(){function t(e,r){var n=this,i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).isActive,o=void 0===i||i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.scene=r,this.isActive=o,this.x=app.camera.x,this.y=app.camera.y,this.titleSize=85,this.titleFont="".concat(this.titleSize,"px Balsamiq Sans"),this.titleColor="#cac7ce",this.titleY=0,this.sectionButtons=[new Ot(e,{text:_.PLAY,handler:function(){return r.changeLayer("Game")},isActive:this.isActive}),new Ot(e,{text:_.CONTROL,handler:function(){return r.changeLayer("Control")},isActive:this.isActive}),new Ot(e,{text:_.ABOUT_THE_GAME,handler:function(){return r.changeLayer("About")},isActive:this.isActive})],this.languageButtons=[new Ot(e,{text:"РУ",handler:function(){return n.changeLanguage("ru")},isActive:this.isActive}),new Ot(e,{text:"EN",handler:function(){return n.changeLanguage("en")},isActive:this.isActive}),new Ot(e,{text:"TR",handler:function(){return n.changeLanguage("tr")},isActive:this.isActive})],this.buttons=[].concat(Tt(this.sectionButtons),Tt(this.languageButtons)),this.init()}var e,r;return e=t,(r=[{key:"changeLanguage",value:function(t){app.user.changeLanguage(t),app.scene.addLayer("Load",Rt),app.scene.start("Main"),app.scene.getLayer("Load").loaded((function(){return app.scene.current.setActive(!0)}))}},{key:"init",value:function(){var t=this,e=-(this.titleSize+80+(this.buttons[0].h+20)*(this.sectionButtons.length+1))/2,r=e+this.titleSize+80+this.buttons[0].h/2;this.titleY=e+this.titleSize,this.sectionButtons.forEach((function(e,n){return e.updatePosition(0,r+(t.buttons[0].h+20)*n)})),this.languageButtons.forEach((function(e,n){return e.updatePosition((t.languageButtons[0].w+20)*n-(t.languageButtons[0].w+20)*(t.languageButtons.length-1)/2,r+(t.buttons[0].h+20)*t.sectionButtons.length)})),this.scene.systemAsteroids.setBoost(!1)}},{key:"destroy",value:function(){this.buttons.forEach((function(t){return t.destroy()})),app.cnv.style.cursor=""}},{key:"setActive",value:function(t){var e=this;this.isActive=t,this.buttons.forEach((function(t){return t.setActive(e.isActive)}))}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.font=this.titleFont,this.ctx.fillStyle=this.titleColor;var t="".concat(_.RECORD,": ").concat(app.user.record),e=this.ctx.measureText(t);this.ctx.fillText(t,-e.width/2,this.titleY),this.buttons.forEach((function(t){return t.draw()})),this.ctx.restore()}},{key:"update",value:function(){app.cnv.style.cursor=this.buttons.some((function(t){return t.hover}))?"pointer":"initial"}}])&&At(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function It(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Lt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Lt(i)?i:String(i)),n)}var i}var _t=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=app.camera.x,this.y=app.camera.y,this.title=_.CONTROL,this.titleSize=85,this.titlePadding=60,this.titleFont="".concat(this.titleSize,"px Balsamiq Sans"),this.titleColor="#cac7ce",this.subTitleSize=50,this.subTitlePadding=10,this.subTitleFont="".concat(this.subTitleSize,"px Balsamiq Sans"),this.subTitleColor="#cac7ce",this.textSize=45,this.textLinePadding=20,this.textFont="".concat(this.textSize,"px Balsamiq Sans"),this.textColor="#cac7ce",this.textBlockPadding=60,this.textBlockX=0,this.textBlockY=0,this.textBlocks=[{title:_.CONTROL_FROM_PC.TITLE,items:_.CONTROL_FROM_PC.ITEMS},{title:_.CONTROL_FROM_MOBILE.TITLE,items:_.CONTROL_FROM_MOBILE.ITEMS}],this.btnBack=new Ot(e,{text:_.BACK,handler:function(){return r.changeLayer("Menu")}}),this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){var t=this,e=this.title,r=this.textBlocks,n=this.titleSize,i=this.subTitleSize,o=this.textSize,a=this.titleFont,s=this.subTitleFont,c=this.textFont,u=this.titlePadding,l=this.subTitlePadding,h=this.textLinePadding,f=this.textBlockPadding,y=this.btnBack.h+n+u;this.ctx.font=a,this.textBlockX=Math.min(-this.ctx.measureText(e).width/2,this.textBlockX),r.forEach((function(e,r){t.ctx.font=s,t.textBlockX=Math.min(-t.ctx.measureText(e.title).width/2,t.textBlockX),y+=i+l+f,e.items.forEach((function(e){e.split("\n").forEach((function(e){t.ctx.font=c,t.textBlockX=Math.min(-t.ctx.measureText(e).width/2,t.textBlockX),y+=o+h}))}))})),this.textBlockY=-y/2+n/2,this.btnBack.updatePosition(0,y/2-this.btnBack.h/2+n/2)}},{key:"destroy",value:function(){this.btnBack.destroy(),app.cnv.style.cursor=""}},{key:"draw",value:function(){var t=this;this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.font=this.titleFont,this.ctx.fillStyle=this.titleColor,this.ctx.fillText(this.title,-this.ctx.measureText(this.title).width/2,this.textBlockY);var e=0,r=0,n=0,i=function(){return t.textBlockY+t.titleSize+t.titlePadding+t.subTitleSize*e+t.subTitlePadding*e+t.textSize*r+t.textLinePadding*r+t.textBlockPadding*n};this.textBlocks.forEach((function(o){t.ctx.font=t.subTitleFont,t.ctx.fillStyle=t.subTitleColor,t.ctx.fillText(o.title,t.textBlockX,i()),e++,o.items.forEach((function(e){var n=e.split("\n");t.ctx.font=t.textFont,t.ctx.fillStyle=t.textColor,n.forEach((function(e){t.ctx.fillText(e,t.textBlockX,i()),r++}))})),n++})),this.btnBack.draw(),this.ctx.restore()}},{key:"update",value:function(t){app.cnv.style.cursor=this.btnBack.hover?"pointer":"initial"}}])&&It(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Dt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Dt(i)?i:String(i)),n)}var i}var Ft=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=app.camera.x,this.y=app.camera.y,this.titleSize=85,this.titleFont="".concat(this.titleSize,"px Balsamiq Sans"),this.titleColor="#cac7ce",this.textSize=45,this.textFont="".concat(this.textSize,"px Balsamiq Sans"),this.textColor="#cac7ce",this.titlePadding=60,this.textLinePadding=20,this.textBlockPadding=60,this.textBlockX=0,this.textBlockY=0,this.title=_.ABOUT_THE_GAME,this.text=_.ABOUT_THE_GAME_DESCRIPTION,this.btnBack=new Ot(e,{text:_.BACK,handler:function(){return r.changeLayer("Menu")}}),this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){var t=this,e=this.titleSize,r=this.titleFont,n=this.textSize,i=this.textFont,o=this.titlePadding,a=this.textLinePadding,s=this.textBlockPadding,c=(this.textBlocks,this.btnBack.h+e+o+s);this.ctx.font=r,this.textBlockX=Math.min(-this.ctx.measureText(this.title).width/2,this.textBlockX),this.text.split("\n").forEach((function(e){t.ctx.font=i,t.textBlockX=Math.min(-t.ctx.measureText(e).width/2,t.textBlockX),c+=n+a})),this.textBlockY=-c/2+e/2,this.btnBack.updatePosition(0,c/2-this.btnBack.h/2+e/2)}},{key:"destroy",value:function(){this.btnBack.destroy(),app.cnv.style.cursor=""}},{key:"draw",value:function(){var t=this;this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.font=this.titleFont,this.ctx.fillStyle=this.titleColor,this.ctx.fillText(this.title,-this.ctx.measureText(this.title).width/2,this.textBlockY);var e=0,r=this.text.split("\n");this.ctx.font=this.textFont,this.ctx.fillStyle=this.textColor,r.forEach((function(r){t.ctx.fillText(r,t.textBlockX,t.textBlockY+t.titleSize+t.titlePadding+t.textSize*e+t.textLinePadding*e),e++})),this.btnBack.draw(),this.ctx.restore()}},{key:"update",value:function(t){app.cnv.style.cursor=this.btnBack.hover?"pointer":"initial"}}])&&zt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Nt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Nt(i)?i:String(i)),n)}var i}var Gt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.current=null,this.layers={}}var e,r;return e=t,(r=[{key:"add",value:function(t,e){this.layers.hasOwnProperty(t)?console.log('Слой "'.concat(t,'" уже добавлен')):this.layers[t]=e}},{key:"start",value:function(t,e,r){this.layers.hasOwnProperty(t)?(null!==this.current&&"destroy"in this.current&&this.current.destroy(),this.current=new this.layers[t](this.ctx,e,r)):console.log('Слой "'.concat(t,'" не найден'))}},{key:"remove",value:function(){}},{key:"draw",value:function(){null!==this.current&&"draw"in this.current&&this.current.draw()}},{key:"update",value:function(t){null!==this.current&&"update"in this.current&&this.current.update(t)}}])&&Wt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Yt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Yt(i)?i:String(i)),n)}var i}var Ht=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.speedMax=e,this.rotateMax=Math.PI/45,this.speed={up:0,down:0,step:.2,max:this.speedMax},this.rotate={current:0,left:0,right:0,step:Math.PI/500,max:this.rotateMax,direction:0,turnDirection:0}}var e,r;return e=t,(r=[{key:"getMove",value:function(t,e,r,n){var i=this.speed,o=this.speedMax;return i.up+=t?Math.min(o-i.up,i.step):-Math.min(i.up,i.step*n),i.down+=e?Math.min(o-i.down,i.step):-Math.min(i.down,i.step*n),K.velocity({x:i.up*Math.sin(r)-i.down*Math.sin(r),y:i.down*Math.cos(r)-i.up*Math.cos(r)},this.speed)}},{key:"getRotation",value:function(t,e,r,n){var i=this.rotate,o=t?0:1,a=e?Math.min(i.max-i.left,i.step):-Math.min(i.left,i.step*n),s=r?Math.min(i.max-i.right,i.step):-Math.min(i.right,i.step*n);if(o===i.direction)i.left+=a,i.right+=s;else{if(0!==i.left||0!==i.right)return i.left=Math.max(i.left-i.step,0),i.right=Math.max(i.right-i.step,0),o?i.left-i.right:i.right-i.left;i.left+=a,i.right+=s,i.direction=o}return o?i.right-i.left:i.left-i.right}},{key:"getRotationCurrent",value:function(){return this.rotate.right-this.rotate.left}},{key:"getRotationDirection",value:function(){return Math.abs(this.rotate.left)>Math.abs(this.rotate.right)?"left":"right"}},{key:"getSpeedCurrent",value:function(){return Math.abs(this.speed.up-this.speed.down)}},{key:"getSpeedDirection",value:function(){return Math.abs(this.speed.up)>Math.abs(this.speed.down)?"up":"down"}}])&&Xt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==qt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===qt(i)?i:String(i)),n)}var i}var Kt=function(){function t(e,r){var n=r.x,i=r.y,o=r.angle,a=r.type,s=r.speed,c=r.speedCurrent;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=0,this.y=-28,this.originPosition={x:n,y:i},this.r=8*s,this.originR=8,this.angle=o+Math.PI,this.type=a,this.color="rgb(202,199,206)",this.stepRadius=K.getRandomDecimal(.05,.2,2),this.rand=0,this.randStep=Math.PI/4*.1,this.dir=K.getRandomDecimal(-1,1,2),this.speed=s,this.diffX=.3,this.speedCurrent=c,"down"===a&&(this.stepRadius*=2.5,this.y=28,this.diffX=3),this.destroyed=!1}var e,r;return e=t,(r=[{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.originPosition.x,this.originPosition.y),this.ctx.rotate(this.angle),this.ctx.fillStyle="rgba(202,199,206, ".concat(this.r/this.originR*this.speed,")"),this.ctx.beginPath(),this.ctx.arc(this.x,this.y,this.r,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}},{key:"update",value:function(t){Math.round(this.r)<=1?this.destroyed=!0:(this.rand+=this.rand+this.randStep*t>Math.PI/2?(Math.PI/2-this.rand)*t:this.randStep*t,this.r=Math.max(this.r-this.stepRadius*t,0),this.speedCurrent-=this.speedCurrent>.2*t?.2*t:0,this.x+=(Math.cos(this.rand)*this.diffX+.05*this.r)*this.dir*this.speed*t,this.y-="down"===this.type?(Math.sin(this.rand)*this.speed-this.speedCurrent)*t:Math.sin(this.rand)*this.speed*t)}}])&&Ut(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Zt(t){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(t)}function Jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Zt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Zt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Zt(i)?i:String(i)),n)}var i}var Vt=function(){function t(e,r){var n=r.x,i=r.y,o=r.angle;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=n,this.y=i,this.r=7,this.angle=o,this.speed=15,this.color="#cac7ce",this.step=K.velocity({x:Math.cos(this.angle-Math.PI/2)*this.speed,y:Math.sin(this.angle-Math.PI/2)*this.speed},this.speed)}var e,r;return e=t,(r=[{key:"getShapeRect",value:function(t,e){return st.getRectOnMoveCircle({x:this.x,y:this.y,r:this.r},t,e)}},{key:"getShapePolygon",value:function(t,e){return st.getPolygonOnMoveCircle({x:this.x,y:this.y,r:this.r},t,e)}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.fillStyle=this.color,this.ctx.arc(0,0,this.r,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}},{key:"getNextMove",value:function(t){return{x:this.step.x*t,y:this.step.y*t}}},{key:"update",value:function(t){this.x+=this.step.x*t,this.y+=this.step.y*t}}])&&Jt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==$t(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===$t(i)?i:String(i)),n)}var i}var te=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=app.camera.x,this.y=app.camera.y,this.armor=0,this.speed=6,this.driving=new Ht(this.speed),this.rotate=0,this.figure=new lt([{x:0,y:80},{x:40,y:0},{x:80,y:80},{x:40,y:60}],5),this.path2D=this.figure.path2D,this.shapePolygon=new it(this.figure.polygon),this.shapeRect=st.getRectFromPolygonRotate(this.shapePolygon.points),this.color="#96919d",this.driveParticles=[],this.bullets=[],this.handlerEventMousedown=this.eventMousedown.bind(this),this.handlerEventMouseup=this.eventMouseup.bind(this),this.handlerEventButtonFire=this.eventButtonFire.bind(this),this.fireTimer=0,this.fireTimeout=15,this.fireState=0,this.armorFillStyle=this.ctx.createRadialGradient(0,0,0,0,0,60),this.armorFillStyle.addColorStop(.5,"rgba(0,0,0,0)"),this.armorFillStyle.addColorStop(1,"rgba(150,145,157,0.1)"),this.armorStrokeStyle="rgba(150,145,157,0.2)",this.init()}var e,r;return e=t,r=[{key:"init",value:function(){app.cnv.addEventListener("mousedown",this.handlerEventMousedown),app.cnv.addEventListener("mouseup",this.handlerEventMouseup),app.stateButtons.on("player_control","fire",this.handlerEventButtonFire)}},{key:"destroy",value:function(){app.cnv.removeEventListener("mousedown",this.handlerEventMousedown),app.cnv.removeEventListener("mouseup",this.handlerEventMouseup),app.stateButtons.off("player_control","fire",this.handlerEventButtonFire)}},{key:"eventButtonFire",value:function(t){t?(this.fireState=1,0===this.fireTimer&&(this.generateBullets(),this.fireTimer+=1)):(this.fireTimer=0,this.fireState=0)}},{key:"eventMousedown",value:function(t){K.isTouchDevice||(this.fireState=1,0===this.fireTimer&&(this.generateBullets(),this.fireTimer+=1))}},{key:"eventMouseup",value:function(t){K.isTouchDevice||(this.fireTimer=0,this.fireState=0)}},{key:"getShapeRect",value:function(t,e){return st.getRectOnMoveRect({x:this.x+this.shapeRect.x,y:this.y+this.shapeRect.y,w:this.shapeRect.w,h:this.shapeRect.h},t,e)}},{key:"getShapePolygon",value:function(t,e,r){var n=this;return this.shapePolygon.points.map((function(i){var o=K.distance(i),a=Math.atan2(i.y,i.x)+n.rotate+r;return{x:n.x+t+Math.cos(a)*o,y:n.y+e+Math.sin(a)*o}}))}},{key:"upArmor",value:function(t){this.armor+=t}},{key:"downArmor",value:function(t){this.armor-=t}},{key:"draw",value:function(){this.driveParticles.forEach((function(t){return t.draw()})),this.bullets.forEach((function(t){return t.draw()})),this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(this.rotate),this.armor&&(this.ctx.beginPath(),this.ctx.arc(0,0,60,0,2*Math.PI),this.ctx.fillStyle=this.armorFillStyle,this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(0,0,60,0,2*Math.PI),this.ctx.strokeStyle=this.armorStrokeStyle,this.ctx.stroke()),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle=this.color,this.ctx.stroke(this.path2D),this.ctx.restore()}},{key:"move",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x+=t,this.y+=e,this.rotate+=r}},{key:"generateBullets",value:function(){this.bullets.push(new Vt(this.ctx,{x:this.x+50*Math.cos(this.rotate-Math.PI/2),y:this.y+50*Math.sin(this.rotate-Math.PI/2),angle:this.rotate}))}},{key:"generateDriveParticles",value:function(){var t=this.driving.getSpeedCurrent(),e=this.driving.getSpeedDirection();t&&this.driveParticles.push(new Kt(this.ctx,{x:this.x,y:this.y,angle:"up"===e?this.rotate:this.rotate-Math.PI,type:e,speed:1/this.speed*t,speedCurrent:t}))}},{key:"getStateControlButton",value:function(t){return app.keyboard.getState(t)||app.stateButtons.getState("player_control",t)}},{key:"getNextMove",value:function(t){var e=this.driving.getMove(this.getStateControlButton("up"),this.getStateControlButton("down"),this.rotate,t);return{x:e.x*t,y:e.y*t}}},{key:"getNextRotate",value:function(t){return this.driving.getRotation(this.getStateControlButton("down"),this.getStateControlButton("left"),this.getStateControlButton("right"),t)*t}},{key:"update",value:function(t){this.bullets=this.bullets.filter((function(e){return!e.destroyed&&(e.update(t),!0)})),this.driveParticles=this.driveParticles.filter((function(e){return!e.destroyed&&(e.update(t),!0)})),this.generateDriveParticles(),this.fireState&&0!==this.fireTimer&&(this.fireTimer<this.fireTimeout?this.fireTimer+=1*t:(this.fireTimer=1,this.generateBullets()))}}],r&&Qt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ee(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ee(i)?i:String(i)),n)}var i}var ne=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.current=e,this.timeout=e,this.step=r}var e,r;return e=t,(r=[{key:"time",get:function(){return this.current}},{key:"update",value:function(){this.current-=1}},{key:"reset",value:function(){this.timeout+=this.step,this.current=this.timeout}}])&&re(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ie(t){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(t)}function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ie(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ie(i)?i:String(i)),n)}var i}var ae=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=r,this.y=n,this.figure=new lt([{x:0,y:0},{x:10,y:0},{x:30,y:0},{x:40,y:0},{x:40,y:30},{x:20,y:40},{x:0,y:30}],20),this.path2D=this.figure.path2D,this.shapePolygon=new it(this.figure.polygon),this.shapeRect=st.getRectFromPolygonRotate(this.shapePolygon.points),this.color=i||"#96919d"}var e,r;return e=t,(r=[{key:"getShapeRect",value:function(){return{x:this.x+this.shapeRect.x,y:this.y+this.shapeRect.y,w:this.shapeRect.w,h:this.shapeRect.h}}},{key:"getShapePolygon",value:function(){var t=this;return this.shapePolygon.points.map((function(e){var r=K.distance(e),n=Math.atan2(e.y,e.x);return{x:t.x+Math.cos(n)*r,y:t.y+Math.sin(n)*r}}))}},{key:"updatePosition",value:function(t,e){this.x=t,this.y=e}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle=this.color,this.ctx.stroke(this.path2D),this.ctx.restore()}}])&&oe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function se(t){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(t)}function ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==se(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===se(i)?i:String(i)),n)}var i}var ue=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.player=r,this.x=app.camera.x,this.y=app.camera.y,this.armorIcon=new ae(e,0,0,"#96919d")}var e,r;return e=t,(r=[{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y);var t=app.camera.size.w/2,e=app.camera.size.h/2;this.ctx.font="".concat(48,"px Balsamiq Sans"),this.ctx.fillStyle="#cac7ce",this.ctx.fillText("".concat(_.SCORE,": ").concat(app.user.score),20-t,48-e+10),this.ctx.fillStyle="#96919d",this.ctx.fillText("".concat(this.player.armor,"%"),85-t,96-e+17),this.armorIcon.draw(),this.ctx.restore()}},{key:"update",value:function(t){this.x=app.camera.x,this.y=app.camera.y,this.armorIcon.updatePosition(-app.camera.size.w/2+45,-app.camera.size.h/2+95)}}])&&ce(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function le(t){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},le(t)}function he(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==le(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===le(i)?i:String(i)),n)}var i}var fe=function(){function t(e,r){var n=r.x,i=r.y,o=r.r,a=r.name,s=r.type;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.type=s||"player_control",this.name=a||"player_control",this.x=n,this.y=i,this.r=o||120,this.state=0,this.touchID=null,this.iconColor="rgba(150, 145, 157, 0.7)",this.handlerTouchStart=this.touchStart.bind(this),this.handlerTouchEnd=this.touchEnd.bind(this),this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){app.cnv.addEventListener("touchstart",this.handlerTouchStart),app.cnv.addEventListener("touchend",this.handlerTouchEnd)}},{key:"destroy",value:function(){app.cnv.removeEventListener("touchstart",this.handlerTouchStart),app.cnv.removeEventListener("touchend",this.handlerTouchEnd)}},{key:"setState",value:function(t){this.state=t,app.stateButtons.setState(this.type,this.name,t)}},{key:"touchStart",value:function(t){if(null===this.touchID){var e=app.cnv.getBoundingClientRect();for(var r in t.touches){var n=(t.touches[r].clientX-e.left)/app.scale-app.size.w/2,i=(t.touches[r].clientY-e.top)/app.scale-app.size.h/2;if(K.distance({x:this.x,y:this.y},{x:n,y:i})<=this.r)return this.setState(1),void(this.touchID=t.touches[r].identifier)}}}},{key:"touchEnd",value:function(t){for(var e in t.changedTouches)if(t.changedTouches[e].identifier===this.touchID)return this.setState(0),void(this.touchID=null)}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.fillStyle="rgba(173, 154, 194, ".concat(this.state?.1:.05,")"),this.ctx.arc(0,0,this.r-20,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}},{key:"updatePosition",value:function(t,e){this.x=t,this.y=e}}])&&he(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ye(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ye(i)?i:String(i)),n)}var i}function ve(){return ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=me(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},ve.apply(this,arguments)}function de(t,e){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},de(t,e)}function me(t){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},me(t)}var be=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&de(t,e)}(a,t);var e,r,n,i,o=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=me(n);if(i){var r=me(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e)).figure=new lt([{x:0,y:100},{x:80,y:0},{x:160,y:100},{x:80,y:40}],10),r}return e=a,(r=[{key:"draw",value:function(){ve(me(a.prototype),"draw",this).call(this),this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.fillStyle=this.iconColor,this.ctx.fill(this.figure.path2D),this.ctx.restore()}}])&&pe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(fe);function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ge(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ge(i)?i:String(i)),n)}var i}function we(){return we="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pe(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},we.apply(this,arguments)}function Se(t,e){return Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Se(t,e)}function Pe(t){return Pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pe(t)}var ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Se(t,e)}(a,t);var e,r,n,i,o=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pe(n);if(i){var r=Pe(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ge(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e)).figure=new lt([{x:0,y:0},{x:50,y:30},{x:100,y:0},{x:50,y:50}],5),r}return e=a,(r=[{key:"draw",value:function(){we(Pe(a.prototype),"draw",this).call(this),this.ctx.save(),this.ctx.translate(this.x,this.y+5),this.ctx.beginPath(),this.ctx.fillStyle=this.iconColor,this.ctx.fill(this.figure.path2D),this.ctx.restore()}}])&&xe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(fe);function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function je(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Oe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Oe(i)?i:String(i)),n)}var i}function Me(){return Me="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ee(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},Me.apply(this,arguments)}function Re(t,e){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Re(t,e)}function Ee(t){return Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ee(t)}var Te=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Re(t,e)}(a,t);var e,r,n,i,o=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ee(n);if(i){var r=Ee(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e)).figure=new lt([{x:0,y:80},{x:100,y:0},{x:40,y:80},{x:100,y:160}],10),r}return e=a,(r=[{key:"draw",value:function(){Me(Ee(a.prototype),"draw",this).call(this),this.ctx.save(),this.ctx.translate(this.x-3,this.y),this.ctx.beginPath(),this.ctx.fillStyle=this.iconColor,this.ctx.fill(this.figure.path2D),this.ctx.restore()}}])&&je(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(fe);function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function Ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ce(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ce(i)?i:String(i)),n)}var i}function Be(){return Be="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ie(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},Be.apply(this,arguments)}function Le(t,e){return Le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Le(t,e)}function Ie(t){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ie(t)}var _e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Le(t,e)}(a,t);var e,r,n,i,o=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ie(n);if(i){var r=Ie(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ce(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e)).figure=new lt([{x:0,y:0},{x:100,y:80},{x:0,y:160},{x:60,y:80}],10),r}return e=a,(r=[{key:"draw",value:function(){Be(Ie(a.prototype),"draw",this).call(this),this.ctx.save(),this.ctx.translate(this.x+3,this.y),this.ctx.beginPath(),this.ctx.fillStyle=this.iconColor,this.ctx.fill(this.figure.path2D),this.ctx.restore()}}])&&Ae(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(fe);function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==De(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==De(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===De(i)?i:String(i)),n)}var i}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=We(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},Fe.apply(this,arguments)}function Ne(t,e){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ne(t,e)}function We(t){return We=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},We(t)}var Ge=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ne(t,e)}(a,t);var e,r,n,i,o=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=We(n);if(i){var r=We(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===De(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,t,e)}return e=a,(r=[{key:"draw",value:function(){Fe(We(a.prototype),"draw",this).call(this),this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.lineWidth=6,this.ctx.strokeStyle=this.iconColor,this.ctx.moveTo(-65,0),this.ctx.lineTo(-25,0),this.ctx.moveTo(25,0),this.ctx.lineTo(65,0),this.ctx.moveTo(0,-65),this.ctx.lineTo(0,-25),this.ctx.moveTo(0,65),this.ctx.lineTo(0,25),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.lineWidth=8,this.ctx.strokeStyle=this.iconColor,this.ctx.arc(0,0,45,0,2*Math.PI),this.ctx.stroke(),this.ctx.restore()}}])&&ze(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(fe);function Ye(t){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ye(t)}function Xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ye(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ye(i)?i:String(i)),n)}var i}var He=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=app.camera.x,this.y=app.camera.y,this.typeButtons="player_control",this.buttons={up:new be(e,{x:this.x,y:this.y,type:this.typeButtons,name:"up"}),down:new ke(e,{x:this.x,y:this.y,type:this.typeButtons,name:"down",r:90}),left:new Te(e,{x:this.x,y:this.y,type:this.typeButtons,name:"left"}),right:new _e(e,{x:this.x,y:this.y,type:this.typeButtons,name:"right"}),fire:new Ge(e,{x:this.x,y:this.y,type:this.typeButtons,name:"fire"})},this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){for(var t in this.buttons)app.stateButtons.add(this.typeButtons,t)}},{key:"destroy",value:function(){for(var t in this.buttons)this.buttons[t].destroy(),app.stateButtons.remove(this.typeButtons,t)}},{key:"draw",value:function(){for(var t in this.ctx.save(),this.ctx.translate(this.x,this.y),this.buttons)this.buttons[t].draw();this.ctx.restore()}},{key:"update",value:function(t){var e=app.camera.size.w/2,r=app.camera.size.h/2;this.x=app.camera.x,this.y=app.camera.y,this.buttons.up.updatePosition(e-300,r-120),this.buttons.fire.updatePosition(e-120,r-300),this.buttons.down.updatePosition(e-520,r-90),this.buttons.left.updatePosition(120-e,r-300),this.buttons.right.updatePosition(300-e,r-120)}}])&&Xe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function Ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==qe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===qe(i)?i:String(i)),n)}var i}var Ke=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.scene=r,this.player=new te(e),this.armors=[],this.timerArtefact=new ne(15,15),this.infoLayer=new ue(e,this.player),this.controlPanelLayer=new He(e),this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){this.scene.systemAsteroids.clear(),this.scene.systemAsteroids.resetCreateTimeout(),this.scene.systemAsteroids.setBoost(!0,.025,4),app.camera.follow(this.player)}},{key:"destroy",value:function(){this.controlPanelLayer.destroy(),this.player.destroy(),app.user.endGame(),app.camera.unFollow()}},{key:"draw",value:function(){this.armors.forEach((function(t){return t.draw()})),this.player.draw(),this.infoLayer.draw(),K.isTouchDevice&&this.controlPanelLayer.draw()}},{key:"update",value:function(t){var e=this,r=[],n=this.player.getNextMove(t),i=this.player.getNextRotate(t),o=this.player.getShapeRect(n.x,n.y),a=this.player.getShapePolygon(n.x,n.y,i),s=app.camera.position,c={x:s.left,y:s.top,w:s.right-s.left,h:s.bottom-s.top};this.armors=this.armors.filter((function(t){return!dt.RectRect(t.getShapeRect(),o)||!dt.PolygonPolygon(t.getShapePolygon(),a)||(e.player.upArmor(100),!1)}));for(var u=0;u<this.scene.systemAsteroids.asteroids.length;u++)if(!this.scene.systemAsteroids.asteroids[u].destroyed){var l=this.scene.systemAsteroids.asteroids[u],h=l.getNextMove(t),f=l.getNextRotate(t),y=l.getShapeRect(h.x,h.y),p=l.getShapePolygon(h.x,h.y,f);if(dt.RectRect(y,o)&&dt.PolygonPolygon(p,a))l.destroyed=!0,this.scene.systemCollisionParticles.create(this.player.x,this.player.y,2*o.w,2*o.h,"#cac7ce"),this.scene.systemCollisionParticles.create(l.x,l.y,y.w,y.h,l.color),this.player.armor>0?this.player.downArmor(25):this.scene.changeLayer("GameOver",app.user.score);else for(var v=0;v<this.player.bullets.length;v++)if(!this.player.bullets[v].destroyed){var d=this.player.bullets[v],m=d.getNextMove(t),b=d.getShapeRect(m.x,m.y);if(dt.RectRect(b,c)){if(dt.RectRect(b,y)&&dt.PolygonPolygon(d.getShapePolygon(m.x,m.y),p)&&(d.destroyed=!0,l.destroyed=!0,this.scene.systemCollisionParticles.create(l.x,l.y,y.w,y.h,l.color),app.user.upScore(10),this.timerArtefact.update(),this.timerArtefact.time<=0&&(this.armors.push(new ae(this.ctx,l.x,l.y)),this.timerArtefact.reset()),y.w*y.h>3e4)){var g=Math.round(y.w/8),x=Math.round(y.w/4),w=y.w/4,S=K.getRandomDecimal(0,2*Math.PI,2),P=Math.min(l.speed+2,8);r.push(this.scene.systemAsteroids.createAsteroidFragment({speed:P,dist:w,minW:g,maxW:x,x:l.x,y:l.y,angle:S+Math.PI/2,color:l.color}),this.scene.systemAsteroids.createAsteroidFragment({speed:P,dist:w,minW:g,maxW:x,x:l.x,y:l.y,angle:S-Math.PI/2,color:l.color}))}}else d.destroyed=!0}}this.player.move(n.x,n.y,i),this.player.update(t),this.infoLayer.update(t),K.isTouchDevice&&this.controlPanelLayer.update(t),this.scene.systemAsteroids.addAsteroids(r)}}])&&Ue(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ze(t){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(t)}function Je(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ze(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ze(i)?i:String(i)),n)}var i}var Ve=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=r,this.y=n,this.r=0,this.maxR=K.getRandomInteger(5,10),this.destroyed=!1,this.a=0,this.increment=K.getRandomDecimal(Math.PI/50,Math.PI/30,2),this.angle=K.getRandomDecimal(0,2*Math.PI,2),this.speed=K.getRandomDecimal(.1,2,2),this.color=i||K.getRandomArguments("#9e99a6","#d9d2e3"),this.opacity=K.getRandomDecimal(.5,1,2),this.step=K.velocity({x:Math.cos(this.angle)*this.speed,y:Math.sin(this.angle)*this.speed},this.speed)}var e,r;return e=t,(r=[{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.beginPath(),this.ctx.fillStyle=this.color,this.ctx.globalAlpha=this.opacity,this.ctx.arc(0,0,this.r,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}},{key:"update",value:function(t){this.destroyed||(this.r=Math.sin(this.a)*this.maxR,this.a+=this.increment*t,this.a>=Math.PI&&(this.destroyed=!0),this.x+=this.step.x*t,this.y+=this.step.y*t)}}])&&Je(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function Qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==$e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==$e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===$e(i)?i:String(i)),n)}var i}var tr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.particles=[]}var e,r;return e=t,(r=[{key:"create",value:function(t,e,r,n,i){for(var o=3*Math.round(r*n/3600),a=r/3,s=n/3,c=0;c<o;c++)this.particles.push(new Ve(this.ctx,K.getRandomInteger(t-a,t+a),K.getRandomInteger(e-s,e+s),i))}},{key:"draw",value:function(){var t=app.camera.position;this.particles.forEach((function(e){!e.destroyed&&e.x+e.r>t.left&&e.x-e.r<t.right&&e.y+e.r>t.top&&e.y-e.r<t.bottom&&e.draw()}))}},{key:"update",value:function(t){this.particles=this.particles.filter((function(e){return!e.destroyed&&(e.update(t),!0)}))}}])&&Qe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==er(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===er(i)?i:String(i)),n)}var i}var nr=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.x=app.camera.x,this.y=app.camera.y,this.score=n||0,this.titleSize=85,this.titleText=app.user.record===this.score?"".concat(_.NEW_RECORD,": ").concat(app.user.record):"".concat(_.SCORE,": ").concat(this.score),this.titleFont="".concat(this.titleSize,"px Balsamiq Sans"),this.titleColor="#cac7ce",this.titleY=0,this.btnReload=new Ot(e,{text:_.AGAIN,handler:function(){return r.changeLayer("Game")}}),this.btnHome=new Ot(e,{text:_.EXIT,handler:function(){return r.changeLayer("Menu")}}),this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){var t=-(this.titleSize+80+2*(this.btnReload.h+20))/2,e=t+this.titleSize+80+this.btnReload.h/2;this.titleY=t+this.titleSize,this.btnReload.updatePosition(0,e),this.btnHome.updatePosition(0,e+this.btnReload.h+20)}},{key:"destroy",value:function(){this.btnReload.destroy(),this.btnHome.destroy(),app.cnv.style.cursor=""}},{key:"draw",value:function(){this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.font=this.titleFont,this.ctx.fillStyle=this.titleColor;var t=this.ctx.measureText(this.titleText);this.ctx.fillText(this.titleText,-t.width/2,this.titleY),this.btnReload.draw(),this.btnHome.draw(),this.ctx.restore()}},{key:"update",value:function(){app.cnv.style.cursor=[this.btnReload,this.btnHome].some((function(t){return t.hover}))?"pointer":"initial"}}])&&rr(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ir(t){return ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ir(t)}function or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ir(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ir(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ir(i)?i:String(i)),n)}var i}var ar=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.systemStars=new tt(e),this.systemCollisionParticles=new tr(e),this.systemAsteroids=new St(e,this,{maxNum:5}),this.layer=new Gt(e),this.isActive=!1,this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){this.layer.add("Menu",Bt),this.layer.add("Control",_t),this.layer.add("About",Ft),this.layer.add("Game",Ke),this.layer.add("GameOver",nr),this.layer.start("Menu",this,{isActive:!1}),app.camera.reset()}},{key:"setActive",value:function(t){this.isActive=t,null!==this.layer.current&&"setActive"in this.layer.current&&this.layer.current.setActive(this.isActive)}},{key:"changeLayer",value:function(t,e){this.isActive&&this.layer.start(t,this,e)}},{key:"draw",value:function(){this.systemStars.draw(),this.systemAsteroids.draw(),this.systemCollisionParticles.draw(),this.layer.draw()}},{key:"update",value:function(t){this.systemStars.update(t),this.systemAsteroids.update(t),this.systemCollisionParticles.update(t),this.layer.update(t)}}])&&or(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function sr(t){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sr(t)}function cr(){cr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new T(n||[]);return i(a,"_invoke",{value:j(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",y="suspendedYield",p="executing",v="completed",d={};function m(){}function b(){}function g(){}var x={};u(x,a,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(C([])));S&&S!==r&&n.call(S,a)&&(x=S);var P=g.prototype=m.prototype=Object.create(x);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(i,o,a,s){var c=h(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==sr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function j(e,r,n){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=M(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var u=h(e,r,n);if("normal"===u.type){if(i=n.done?v:y,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function M(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=h(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,d;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(sr(e)+" is not iterable")}return b.prototype=g,i(P,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},k(O.prototype),u(O.prototype,s,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new O(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(P),u(P,c,"Generator"),u(P,a,(function(){return this})),u(P,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function ur(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function lr(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){ur(o,n,i,a,s,"next",t)}function s(t){ur(o,n,i,a,s,"throw",t)}a(void 0)}))}}var hr=document.getElementById("cnv");function fr(){return yr.apply(this,arguments)}function yr(){return(yr=lr(cr().mark((function t(){var e;return cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=new FontFace("Balsamiq Sans","url(./assets/fonts/BalsamiqSans-Regular.ttf)"),t.next=4,e.load();case 4:document.fonts.add(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function pr(){var t=document.getElementById("btnFullscreen");function e(){document.fullscreenElement?(document.exitFullscreen(),t.classList.remove("active")):r()}function r(){document.documentElement.requestFullscreen(),t.classList.add("active")}window.addEventListener("click",(function(){r(),t.addEventListener("click",e)}),{once:!0}),window.addEventListener("fullscreenchange",(function(){document.fullscreenElement?t.classList.add("active"):t.classList.remove("active")}))}window.app=new H(hr),app.scene.add("Main",ar),app.scene.addLayer("Load",Rt),lr(cr().mark((function t(){return cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return pr(),t.next=3,fr();case 3:app.scene.start("Main"),app.scene.getLayer("Load").loaded((function(){return app.scene.current.setActive(!0)}));case 4:case"end":return t.stop()}}),t)})))()}()}();